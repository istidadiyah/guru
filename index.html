<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta property="og:title" content="Aplikasi Isti'dadiyah">
    <meta property="og:description" content="Aplikasi khusus untuk guru Isti'dadiyah">
    <meta property="og:image" content="https://istidadiyah.github.io/guru/bg.jpg">
    <meta property="og:url" content="https://istidadiyah.github.io/guru">
    <meta property="og:type" content="website">

    
    <link rel="icon" href="logo.png" type="image/x-icon">

    <link rel="manifest" href="https://istidadiyah.github.io/guru/manifest.json">
    
    <meta name="Description" content="Ini adalah aplikasi pwa Istidadiyah" />
    <!-- Mendeklarasikan warna yang muncul pada address bar Chrome versi seluler -->
    <meta name="theme-color" content="#414f57" />
    <!-- Mendeklarasikan ikon untuk iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Nama Situs" />
    <link rel="apple-touch-icon" href="icon-192x192.png" />
    <!-- Mendeklarasikan ikon untuk Windows -->
    <meta name="msapplication-TileImage" content="icon-192x192.png" />
    <meta name="msapplication-TileColor" content="#000000" />




    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome untuk ikon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/2.1.8/css/dataTables.dataTables.css">

    <!-- Buttons DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.dataTables.min.css">

    <!-- SearchBuilder CSS -->
    <link href="https://cdn.datatables.net/searchbuilder/1.4.3/css/searchBuilder.bootstrap5.min.css" rel="stylesheet">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">


    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles/style.css">
    <link rel="stylesheet" href="styles/header.css">
    <link rel="stylesheet" href="styles/tabel.css">
    <link rel="stylesheet" href="styles/splas.css">

    <link id="themeStylesheet" rel="stylesheet" href="styles/tema/light.css">
    
    <title>Isti'dadiyah</title>

</head>
<body>
    <!-- Splash Screen -->
<div id="splash-screen">
    <div class="splash-content">
        <img src="https://istidadiyah.github.io/guru/icon-512x512.png" alt="Logo" id="splash-logo"/>
        <h1>Welcome to Isti'dadiyah App</h1>
    </div>
</div>

    <!-- SVG Container -->
    <div class="svg-container">
        <svg viewBox="0 0 800 400" class="svg">
            <path id="curve" fill="#50c6d8" d="M 800 300 Q 400 350 0 300 L 0 0 L 800 0 L 800 300 Z"></path>
        </svg>
    </div>

    <!-- Header -->
    <header>
        <h1 id="headerInfo">Isti'dadiyah</h1>
        <div class="sub-title" id="tanggalInfo">Aplikasi Khusus Guru Isti'dadiyah</div>
        <div class="container-flex mt- d-flex justify-content-center">
            <div id="tombolHome" class="grid-item" style="display: none;">
                <a href="javascript:void(0)" onclick="home()">
                    <i id="iconHome" class="fas fa-home fa-2x"></i>
                </a>
            </div>
        </div>
    </header>

    <!-- Tampilan antrian di pojok kanan atas -->
    <div id="antrianCounter" style="display: none;">
        0
    </div>
    <div id="antrianJson" style="display: none;">
        0
    </div>

    <!-- Main Container -->
    <div class="container">

        <!-- Main Navigation Cards -->
        <div id="cardIcon" class="card shadow-sm mt-4">
            <div id="loadingSpinner" class="loading-spinner" style="display: none;">
                <div class="spinner-inner">
                    <img src="logo.png" alt="Logo" class="logo">
                </div>
            </div>
            <div id="loadingIndicator" style="display: none;">Loading...</div>

            <div class="container-flex mt-5">
                <!-- Links Grid -->
                <div class="grid-item">
                    <a href="javascript:void(0)" onclick="KelasButton()">
                        <i class="fas fa-chalkboard-teacher fa-2x"></i>
                        <div>Kelas</div>
                    </a>
                </div>
                
                <div class="grid-item">
                    <a href="javascript:void(0)" onclick="AbsensiButton()">
                        <i class="fas fa-calendar-check fa-2x"></i>
                        <div>Absensi</div>
                    </a>
                </div>
                <div class="grid-item">
                    <a href="halaman/Kuartar.html">
                        <i class="fas fa-pencil-alt fa-2x"></i>
                        <div>Kuartal</div>
                    </a>
                </div>
                <div class="grid-item">
                    <a href="javascript:void(0)" onclick="BiodataButton()">
                        <i class="fas fa-id-card fa-2x"></i>
                        <div>Biodata</div>
                    </a>
                </div>
                <div class="grid-item">
                    <a href="halaman/pelajaran.html">
                        <i class="fas fa-book-open fa-2x"></i>
                        <div>Pelajaran</div>
                    </a>
                </div>
                <div class="grid-item">
                    <a href="halaman/syahriyah.html">
                        <i class="fas fa-money-bill-wave fa-2x"></i>
                        <div>Syahriyah</div>
                    </a>
                </div>
                <div class="grid-item">
                    <a href="javascript:void(0)" onclick="GuruButton()">
                        <i class="fas fa-user fa-2x"></i>
                        <div>Guru</div>
                    </a>
                </div>
                <div class="grid-item">
                    <a href="halaman/syahriyah.html">
                        <i class="fas fa-clock fa-2x"></i>
                        <div>Jadwal</div>
                    </a>
                </div>
                
                <div class="grid-item">
                    <a href="javascript:void(0)" onclick="SettingButton()">
                        <i class="fas fa-cog fa-2x"></i>
                        <div>Setting</div>
                    </a>
                </div>
                <div class="grid-item">
                    <a href="javascript:void(0)" onclick="GagalButton();">
                        <i class="fas fa-exclamation-triangle fa-2x" style="color: red;"></i>
                        <div>Offline</div>
                    </a>
                </div>
                
                <div class="grid-item">
                    <a href="javascript:void(0)" onclick="fetchDataFromAppScript(forceRefresh = true);">
                        <i class="fas fa-sync fa-2x"></i>
                        <div>Reload</div>
                    </a>
                </div>
                
            </div>
        </div>
        
        <div class="modal fade" id="cardEdit" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <!-- Konten dari form.html akan dipindahkan ke sini -->
                     <!-- Modal Edit -->
                        
                </div>
            </div>
        </div>

        <!-- Modal Edit -->
         <div id="cardTabel">
            <!-- Card Tables -->
            <div id="cardSantri" class="card shadow-sm mt-4 card-custom" style="display: none;">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h2>Isti'dadiyah</h2>
                        <select id="kelmdFilter" class="form-select" style="width:auto;">
                            <option value="">All</option>
                            <!-- Opsi akan diisi secara dinamis oleh JavaScript -->
                        </select>
                    </div>
                    <p id="Hijriyah">Tanggal Hijiriyah</p>
                    <div id="cardFilter">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <select id="filterJam" class="form-select" style="width:100%;">
                                <option value="M">Malam</option>
                                <option value="1">Jam 1</option>
                                <option value="2">Jam 2</option>
                            </select>
                            <select id="filterTanggal" class="form-select" style="width:auto;">
                                <script>
                                    for (let i = 1; i <= 31; i++) {
                                        document.write('<option value="' + i + '">' + i + '</option>');
                                    }
                                </script>
                            </select>
                            
                        </div>
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <select id="filterBulan" class="form-select" style="width:100%;">
                                <option value="">All</option>
                                <!-- Opsi akan diisi secara dinamis oleh JavaScript -->
                            </select>
                            <button type="submit" class="btn btn-primary" onclick="RekapButton()">Rekap</button>
                        </div>
                    </div>
                    <div id="TabelUmum">
                        <table id="Santri" class="table table-hover table-bordered"></table>
                    </div>
                </div>
            </div>
            <div id="cardRekap" class="card shadow-sm mt-4 card-custom" style="display: none;">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h2>Rekap Absen</h2>
                        <button type="submit" class="btn btn-primary" onclick="AbsensiButton()">Absensi</button>
                    </div>
                    <table id="Rekap" class="table table-hover table-bordered table-striped table-compact"></table>
                </div>
            </div>
            <div id="cardGuru" class="card shadow-sm mt-4 card-custom" style="display: none;">
                <div class="card-body">
                    <h2>Asatidz & Asatidzah</h2>
                    <table id="Guru" class="table table-hover table-compact"></table>
                </div>
            </div>
            <div id="cardKelompok" class="card shadow-sm mt-4 card-custom">
                <div class="card-body">
                    <h2>Kelas</h2>
                    <table id="Kelompok" class="table table-hover table-compact"></table>
                </div>
            </div>
        
            <div id="cardPost" class="card shadow-sm mt-4 card-custom" style="display: none;">
                <div class="card-body">
                    <h2>Data Local</h2>
                    <p>Data yang belum dikirim Ke SERVER akan tampil di sini!</p>
                    <p>Silahkan klik tombol 'ulangi' untuk mencoba mengirim ulang!</p>
                    <table id="tablePost" class="table table-striped table-bordered"></table>
                </div>
            </div>

        </div>
    </div>

    

    <!-- Settings Section -->
    <div id="cardSetting" class="card shadow-sm mt-4 card-custom" style="display: none;">
        
        <div class="container">
            <ul class="settings-list">
                <!-- Informasi Guru -->
                <li class="settings-item">
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <div>
                            <h5 id="NamaGuru" style="margin: 0; font-weight: bold;"></h5>
                            <h6 id="IDGuru" style="margin: 0; font-size: 14px; color: #888;"></h6>
                        </div>
                    </div>
                </li>
        
                <!-- Pengaturan Akun -->
                <li class="settings-item">
                    <div style="display: flex; align-items: center;">
                        <i class="fas fa-user settings-icon"></i>
                        <span>Pengaturan Akun</span>
                    </div>
                    <a href="akun.html" class="btn btn-outline-primary btn-sm">Kelola</a>
                </li>
        
                <!-- Mode Gelap -->
                <li class="settings-item">
                    <div style="display: flex; align-items: center;">
                        <i class="fas fa-moon settings-icon"></i>
                        <span>Mode Gelap</span>
                    </div>
                    <div class="toggle-switch">
                        <input class="form-check-input" type="checkbox" id="darkModeToggle" onclick="toggleTheme()">
                        <label class="form-check-label" for="darkModeToggle"></label>
                    </div>
                </li>
        
                <!-- Tentang -->
                <li class="settings-item">
                    <div style="display: flex; align-items: center;">
                        <i class="fas fa-info-circle settings-icon"></i>
                        <span>Tentang</span>
                    </div>
                    <a href="about.html" class="btn btn-outline-primary btn-sm">Lihat</a>
                </li>
        
                <!-- Panduan Penggunaan -->
                <li class="settings-item">
                    <div style="display: flex; align-items: center;">
                        <i class="fas fa-book-reader settings-icon"></i>
                        <span>Panduan Penggunaan</span>
                    </div>
                    <a href="panduan.html" class="btn btn-outline-primary btn-sm">Baca</a>
                </li>

                <li class="settings-item">
                    <div style="display: flex; align-items: center;">
                        <i class="fas fa-sign-out-alt settings-icon"></i>
                        <span>Chache</span>
                    </div>
                    <button class="btn btn-danger btn-sm" id="logoutBtn" onclick="clearSiteCache()">Hapus Semua Chache</button>
                </li>
                <!-- Tombol Keluar dan Hapus Cache -->
                <li class="settings-item">
                    <div style="display: flex; align-items: center;">
                        <i class="fas fa-sign-out-alt settings-icon"></i>
                        <span>Keluar</span>
                    </div>
                    <button class="btn btn-danger btn-sm" id="logoutBtn" onclick="logout()">Keluar</button>
                </li>

            </ul>
        </div>
        
    </div>


    <!-- JS Scripts -->
    <script src="scripts/setting.js" defer></script>
    <script src="scripts/select.js"></script>
    <script src="scripts/online.js"></script>
    <script src="scripts/tabel.js"></script>
    <script src="scripts/header.js"></script>
    <script src="scripts/tombol.js"></script>
    <script src="scripts/Fungsi.js"></script>
    
    

    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Library untuk Bootstrap JS Framework -->

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <!-- Library inti jQuery -->

    <!-- DataTables Core JS -->
    <script src="https://cdn.datatables.net/2.1.8/js/dataTables.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>
    <!-- Library DataTables dengan integrasi Bootstrap 5 -->

    
    <!-- Export Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <!-- JSZip untuk ekspor Excel, pdfmake untuk ekspor PDF -->

    <!-- DataTables Buttons Extensions -->
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.bootstrap5.min.js"></script>
    <!-- Fitur tambahan tombol DataTables: ekspor ke Excel, PDF, print, visibilitas kolom -->

    <!-- DataTables SearchBuilder -->
    <script src="https://cdn.datatables.net/searchbuilder/1.4.3/js/dataTables.searchBuilder.min.js"></script>
    <script src="https://cdn.datatables.net/searchbuilder/1.4.3/js/searchBuilder.bootstrap5.min.js"></script>
    <!-- SearchBuilder untuk fitur pencarian lanjutan dengan integrasi Bootstrap 5 -->

    


    <script>
        // Memuat data dari localStorage setelah login berhasil
        window.addEventListener('DOMContentLoaded', function () {
            const userID = localStorage.getItem('userID');
            const userName = localStorage.getItem('userName');
    
            if (userID && userName) {
                // Menampilkan ID dan Nama pengguna pada elemen yang ada di index.html
                const namaGuruElement = document.getElementById('NamaGuru');
                const idGuruElement = document.getElementById('IDGuru');
    
                if (namaGuruElement && idGuruElement) {
                    namaGuruElement.textContent = userName;
                    idGuruElement.textContent = userID;
                } else {
                    console.error('Elemen NamaGuru atau IDGuru tidak ditemukan di HTML.');
                }
            } else {
                // Jika data tidak ditemukan, redirect ke halaman login
                console.warn('Data userID atau userName tidak ditemukan di localStorage.');
                window.location.href = 'login.html';
                return; // Menghentikan eksekusi kode berikutnya
            }
    
            // Memastikan jQuery sudah siap sebelum melanjutkan
            $(document).ready(function () {
                // Memanggil fetchDataFromAppScript dengan parameter yang sesuai
                fetchDataFromAppScript({
                    "db": { "Diniyah": "Isti", "StatusSantri": "Mukim" }, // Cache 24 jam
                    "Absen": {}, // Default cache duration
                    "Kelompok": {},
                    "Guru": {},
                    "Pelajaran": {}
                }, false); // false berarti menggunakan cache
            });
        });
    </script>
    
    <script>
            // Menghilangkan splash screen setelah animasi selesai (4 detik)
        window.addEventListener('load', () => {
            setTimeout(() => {
                const splash = document.getElementById('splash-screen');
                splash.style.display = 'none'; // Sembunyikan splash screen setelah 4 detik
            }, 4000); // Durasi animasi
        });
    </script>

    <script>
        // Cek dukungan Service Worker
        if ('serviceWorker' in navigator) {
            // Pastikan HTTPS atau localhost
            if (location.protocol === 'https:' || location.hostname === 'localhost') {
                navigator.serviceWorker.register('https://istidadiyah.github.io/guru/sw.js?v=2.0') // Versi untuk mencegah cache
                    .then(() => console.log('Service Worker berhasil didaftarkan.'))
                    .catch((error) => {
                        console.error('Pendaftaran Service Worker gagal:', error.message);
                        console.error('Detail error:', error);
                    });
            } else {
                console.warn('Service Worker hanya didukung di HTTPS atau localhost.');
            }
        } else {
            console.warn('Browser Anda tidak mendukung Service Worker.');
        }
    </script>
    
    


</body>
</html>
